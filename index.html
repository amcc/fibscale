<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fibonacci scale</title>
    <link rel="stylesheet" href="style.css" />
    <script type="text/javascript">
      window.addEventListener("DOMContentLoaded", () => {
        let textStart = 10;
        let fibSeq = [1, 2];
        let shiftArray = [];
        let shift = 0;
        let fibLength = 14;
        const sequence = document.getElementById("sequence");
        const slider = document.querySelector("input[type=range]");
        const number = document.querySelector("input[type=number]");
        const reset = document.querySelector("button");

        reset.addEventListener("click", (e) => {
          e.preventDefault();
          slider.value = 0;
          number.value = 0;
          shift = 0;
          shifter(fibSeq);
          sizeOutput();
        });

        number.addEventListener("input", (e) => {
          slider.value = e.target.value;
          shift = e.target.value;
          shifter(fibSeq);
          sizeOutput();
        });
        slider.addEventListener("input", (e) => {
          number.value = e.target.value;
          shift = e.target.value;
          shifter(fibSeq);
          sizeOutput();
        });

        const shifter = (array) => {
          shiftArray = array.map((num) => num + Number(shift));

          makeString(shiftArray);
        };

        const generate = () => {
          // for loop to generate fibonacci sequence
          for (let i = 0; i < fibLength; i++) {
            fibSeq.push(fibSeq[i] + fibSeq[i + 1]);
          }
        };

        const makeString = (array) => {
          // string from fibSeq comma separated
          let fibSeqString = array.join(", ");

          sequence.innerHTML = fibSeqString;
        };

        generate();
        shifter(fibSeq);
        makeString(fibSeq);

        const sizeOutput = () => {
          const output = document.getElementById("output");
          const outputEls = output.querySelectorAll("span");
          const outputpx = document.getElementById("output-px");
          const outputElsPx = outputpx.querySelectorAll("span");
          console.log("size");
          outputEls.forEach((span, i) => {
            span.style.fontSize = null;
            span.style.fontSize = `${
              shiftArray[textStart - i] > 0 ? shiftArray[textStart - i] : 0
            }px`;
          });
          outputElsPx.forEach((span, i) => {
            span.style.fontSize = null;
            span.style.fontSize = `${shiftArray[textStart - i]}px`;
            span.innerHTML = `${shiftArray[textStart - i]}`;
          });
        };
        sizeOutput();
      });
    </script>
  </head>
  <body>
    <main>
      <div class="first">
        <header>
          <section>
            <h1>Fibonacci</h1>
            <div id="sequence">hi</div>
          </section>
        </header>
        <article>
          <section>
            <p>
              The fibonnaci scale is formed by adding the previous two numbers.
              Customise the scale with the slider & input to add/subtract a
              value to each number.
            </p>
          </section>
        </article>
      </div>
      <div class="second">
        <section class="inputs">
          <form>
            <div id="slider">
              <input type="range" min="-50" max="50" step="1" value="0" />
            </div>
            <div id="number"><input type="number" value="0" /></div>
            <div id="button"><button>reset</button></div>
          </form>
        </section>
        <section id="output" class="output">
          <span>One</span>
          <span>should</span>
          <span>never</span>
          <span>mistake</span>
          <span>pattern</span>
          <span>for</span>
          <span>meaning</span>
        </section>
        <section id="output-px" class="output">
          <span></span>
          <span></span>
          <span></span>
          <span></span>
          <span></span>
          <span></span>
          <span></span>
        </section>
      </div>
    </main>
    <footer>
      <section class="footer-text">
        <p>
          In the example above the sequence begins as a normal Fibonacci
          sequence. By moving the slider you shift all the numbers up or down by
          that value. It will then not be a Fibonacci sequence, but the gaps
          will all be the same as the original. This can be useful when using it
          as a font scale, but you want it to include 16px as your base font
          size for instance.
        </p>
        <p>
          In mathematics, the Fibonacci numbers form a sequence, in which each
          number is the sum of the two preceding ones. The first few values in
          the sequence are: 0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144. The
          Fibonacci numbers were first described in Indian mathematics, as early
          as 200 BC in work by Pingala on enumerating possible patterns of
          Sanskrit poetry formed from syllables of two lengths. They are named
          after the Italian mathematician Leonardo of Pisa, later known as
          Fibonacci, who introduced the sequence to Western European mathematics
          in his 1202 book Liber Abaci.
          <a href="https://en.wikipedia.org/wiki/Fibonacci_number"
            >find out more on wikipedia</a
          >
        </p>
      </section>
      <section class="made-by">
        Made by <a href="https://amcc.io">amcc.io</a>
      </section>
    </footer>
  </body>
</html>
